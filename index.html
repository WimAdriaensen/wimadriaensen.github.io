<!DOCTYPE html>
<html>
  <head>
    <title>Courses API</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Dit is een HTML testing page">
    <meta name="author" content="Wim Adriaensen">
    
    <script defer src="https://unpkg.com/alpinejs@3.5.0/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
   <div class="container bg-light my-3">
   
    <h1 class="text-center py-3">Welcome to my courses API</h1>
    
    <div class="row justify-content-center py-3">
        <div class="col-auto" x-data="{
        courses: null,
        async getData() {
            this.courses = await (await fetch('https://api-wimadriaensen.cloud.okteto.net/courses')).json();
        }
        }" x-init="getData">

            <table class="table table-responsive">
                <thead>
                    <tr class="text-center">
                        <th>ID</th>
                        <th>Course name</th>
                        <th>Lecturer</th>
                    </tr>
                </thead>
                <tbody>
                    <template x-for="course in courses">
                      <tr class="text-center">
                          <td class="px-3" x-text="course.id"></td>
                          <td class="px-3" x-text="course.name_course"></td>
                          <td class="px-3" x-text="course.lecturer"></td>
                      </tr>
                    </template>
                </tbody>
            </table>
            <div class="text-end">
                <button x-on:click="getData">Refresh</button>
            </div>
        </div>
    </div>
    
    <h2>Creating new course</h2>
    
    <div x-data="{
        responsedata: null,
        lecturer: null,
        name_course: null,
        data: null,
        async createCourse() {
            data = await (await fetch('https://api-wimadriaensen.cloud.okteto.net/courses')).json()
            this.responsedata = await (await fetch('https://api-wimadriaensen.cloud.okteto.net/courses', 
            {
                method: 'POST',
                body: JSON.stringify({
                    id: (data.length + 1),
                    name_course: this.name_course,
                    lecturer: this.lecturer,
                }),
                headers: {
                    'Content-type': 'application/json; charset=UTF-8',
                },
            })).json();

            console.log(this.responsedata);
        },
    }">  
       
        <table>
           <thead>
               <tr>
                   <th>Lecturer:</th>
                   <th>Course name:</th>
               </tr>
           </thead>
           <tbody>
               <tr>
                   <td>
                       <input type="text" x-model="lecturer">
                   </td>
                   <td>
                       <input type="text" x-model="name_course">
                   </td>
               </tr>
           </tbody>
        </table>

        <button x-on:click="createCourse">Create course</button>

        <p>Data inserted with id: <strong x-text="responsedata.id"></strong></p>
        <p>Name that was inserted: <strong x-text="responsedata.name_course"></strong></p>
        <p>Lecturer that was inserted: <strong x-text="responsedata.lecturer"></strong></p>


      </div>

</div>
</body>
</html>
